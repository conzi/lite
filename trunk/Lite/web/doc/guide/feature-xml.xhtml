<html xmlns:x="http://www.xidea.org/lite/example" xmlns="http://www.w3.org/1999/xhtml"
	xml:lang="zh-CN" dir="ltr">
	<head>
		<title>其他标记语言特有的语法</title>
	</head>
	<body>
		<h3>功能支持</h3>
		<p>
			<ul>
				<li>
					条件属性
					<p>当属性输出 (如&lt;button disabled="${action.disabled || null}" ..)。
						如果属性是一个唯一的表达式(没有其他语法或者文本)；且表达式值为null时(null 非
						"null")，该属性将做为一个整理不被输出（属性名等也不会输出）
					</p>
				</li>
				<li>
					自动编码
					<p>Lite 模板系统能够根据模板的语言上下文，自动作出合理的编码，从源头杜绝XSS漏洞和不规范的代码书写方式。</p>
					<p>
						具体功能上将遵从如下六条规则
						<ul>

							<li>
								普通的XML/HTML文本将按XML文本规则编码：必须编码
								<strong>&<</strong>
								两个XML特殊字符
							</li>
							<li>
								普通的XML/HTML属性将按XML属性规则编码：必须编码
								<strong>&<"</strong>
								三个XML特殊字符（所有XML属性将自动规范为" 做为属性引号！）
							</li>

							<li>src,href,form@action等，属性中出现的模板变量，将先做自动url编码（encodeURIComponent），再做html属性编码
							</li>
							<li>on* (事件脚本) 中出现的模板变量，将先做JSON.stringify 编码再做XML属性编码</li>
							<li>script 中出现的模板变量，将做JSON.stringify
								编码（script默认自动增加CDATA，所有不做XML编码）。</li>
							<li>&lt[CDATA[段，将不做XML编码，script节点将自动加上必要的CDATA段 </li>

						</ul>
					</p>
				</li>
				<li>自动HTML标签补全
				</li>
			</ul>
		</p>
		<h3>用法示例</h3>
		<ul>

			<x:code var="autoformModel">
			<![CDATA[
			{
				title:"特殊字符\"&&lt;",
				cityList:["北京","杭州","上海"],
				user:{name:"金大为",city:"杭州",married:true}
			}
			]]>
			</x:code>
			<x:code model="autoformModel">
		<![CDATA[
		<!-- 自动表单填充 -->
		<form h:autoform="true">
			大名：<input name="user.name" type="text"/>
			城市：<select name="user.city">
					<option c:for="${city:cityList}">${city}</option>
				</select>
			婚否： <input name="user.married" type="radio" value="true"/>是
				  <input name="user.married" type="radio" value="false"/>否
		</form>
		]]>
			</x:code>
			<br />
			<br />
			<x:code var="htmlxmlModel">
					<![CDATA[
					{
						title:"特殊字符\"&&lt;",
						content:"危险代码&lt;script>alert(\"想做点坏事，能得逞吗？\") &lt;\/script>",
						"disabled":null,
						data:{p1:"属性1",p2:"属性2"}
					}
					]]>
			</x:code>
			<x:code model='htmlxmlModel'>
					<![CDATA[
					<!-- html/xml 条件属性
							若 disabled 变量为null， 则disabled 属性不输出 -->
					<input type="submit" disabled="${disabled}" value=""/>
					
					....
					<!-- javascript自动编码(JSON.stringify) -->
					<div onclick="alert(${content})">...</div>
					<!-- URL 自动编码(encodeURIComponent) -->
					<a href="/test?p1=${data.p1}&p2=${data.p2}&p3=${'中文自动编码'}">...</a>
					<!-- html自动编码  -->
					<p title="${title}">${content}</p>
					<script>
						//script 中的内容将自动放到CDATA块中，其内容不做自动编码
						if(content.length<10){
							alert(content.length);
						}
						alert(${content})
					</script>
					
					
					...
					<!-- 自动Hash戳（用于设置服务器永久缓存）和文件缺失检查【该功能只在上线编译时启用】 -->
					<link href="/styles/default.css" type="text/css" rel="stylesheet"/>
					<script src="/scripts/boot.js"/>
					<!-- 自动图片文件信息补全(width,height) 【该功能只在上线编译时启用】-->
					<img src="/images/logo.png"/>
					]]>
			</x:code>

		</ul>
	</body>
</html>
