<html xmlns:c="http://www.xidea.org/ns/lite">
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
		<link href="http://jsicdn.appspot.com/styles/default.css" rel="Stylesheet" type="text/css"/>
		
		<script src="http://jsicdn.appspot.com/cdn/=
					org.xidea.lite.Template
					+org.jside.E
					+org.jside.Cookie
					+org.jside.JSON"></script>
		<title>小饭团程序</title>
	</head>
	<body>
		<h3>迷你小饭团程序</h3>
		<div id="content"></div>
		<script>
		//模型层
		var model = {
			"userList":[
				{"name":"金大为","deposited":100,"cost":10},
				{"name":"路人甲","deposited":20,"cost":45},
				{"name":"路人乙","deposited":45,"cost":10},
			]
		};
		var dao = new Cookie("date","/",new Date(2200));
		function save(data){
			dao.set(encode(JSON.encode(data)));
		}
		function load(){
			var data = dao.get();
			return data?JSON.decode(data):model;
		}
		model = load();
		</script>
		<script>
		//控制层
		
		var controller = {
			cost:function(users,amount){
				users = getUsers(users);
				var userAmount = amount/users.length;
				for(var i = 0;i<users.length;i++){
					model.userList[item.value].cost +=userAmount;
				}
				repaint();
			},
			pay:function(users,amout){
			}
		}
		
		function getUsers(users){
			var result = [];
			for(var i=0;i<users.length;i++){
				var item = users[i];
				if(item.checked){
					result.push(item.value);
				}
			}
			return result;
		}
		</script>
		<script>
		//视图层
		function repaint(){
			E("content").innerHTML = template.render(model);
		}
		//警告：前端模板可不能這么用！！！
		var template = new Template("template.xhtml#//c:client/*");
		repaint();
		</script>
	</body>
</html>